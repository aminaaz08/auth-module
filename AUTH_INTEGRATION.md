# –ú–æ–¥—É–ª—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ ‚Äî –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑:
- –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π –∫–æ–¥ (–Ω–∞ email),
- GitHub OAuth,
- –Ø–Ω–¥–µ–∫—ÅID.

–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ MongoDB, –≤—ã–¥–∞—ë—Ç—Å—è JWT-—Ç–æ–∫–µ–Ω, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥—Ä—É–≥–∏–º —á–∞—Å—Ç—è–º —Å–∏—Å—Ç–µ–º—ã.

---

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ

### 1. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.9+
- MongoDB (–ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ Atlas)
- –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞
#### –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–µ—Å–ª–∏ –µ—â—ë –Ω–µ —Å–¥–µ–ª–∞–Ω–æ)
```
git clone <https://github.com/aminaaz08/auth-module>
cd auth-module
```
#### –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```
python -m venv venv
source venv/bin/activate      # Linux/Mac
venv\Scripts\activate         # Windows
```
#### –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```
pip install -r requirements.txt
```
### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞
—Ñ–∞–π–ª .env –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

.env
```
#¬†–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ¬†–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
MONGODB_URL=mongodb://localhost:27017
DB_NAME=auth_dbSECRET_KEY=–≤–∞—à_–Ω–∞–¥—ë–∂–Ω—ã–π_—Å–µ–∫—Ä–µ—Ç–Ω—ã–π_–∫–ª—é—á_–¥–ª–∏–Ω–æ–π_–º–∏–Ω–∏–º—É–º_32_—Å–∏–º–≤–æ–ª–∞
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=1440

#¬†–î–ª—è¬†GitHub¬†OAuth¬†(–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
GITHUB_CLIENT_ID=–≤–∞—à_client_id
GITHUB_CLIENT_SECRET=–≤–∞—à_client_secret

# –î–ª—è –Ø–Ω–¥–µ–∫—ÅID (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
YANDEX_CLIENT_ID=–≤–∞—à_yandex_client_id
YANDEX_CLIENT_SECRET=–≤–∞—à_yandex_client_secret
```
–°–æ–≤–µ—Ç: –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ SECRET_KEY –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
python
```
import¬†secrets
print(secrets.token_hex(32))
```

### 4. –ó–∞–ø—É—Å–∫
bash
```
uvicorn¬†main:app¬†--reload
```
–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:
http://localhost:8000

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API:
http://localhost:8000/docs

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

üîë –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ –∫–æ–¥—É
–ó–∞–ø—Ä–æ—Å–∏—Ç—å –∫–æ–¥
POST /auth/code/request
–¢–µ–ª–æ: {"email": "user@example.com"}
‚Üí –ö–æ–¥ –ø–æ—è–≤–∏—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞ (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ email/Telegram).
–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∫–æ–¥
POST /auth/code/verify
–¢–µ–ª–æ: {"email": "user@example.com", "code": "123456"}
‚Üí –í –æ—Ç–≤–µ—Ç–µ: {"access_token": "...", "token_type": "bearer"}

üîó –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ GitHub
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ —Å—Å—ã–ª–∫–µ:
http://localhost:8000/auth/github
–ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ JWT-—Ç–æ–∫–µ–Ω –≤ URL (–¥–ª—è –¥–µ–º–æ).

üîµ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—ÅID
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ —Å—Å—ã–ª–∫–µ:
http://localhost:8000/auth/yandex
–ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ JWT-—Ç–æ–∫–µ–Ω –≤ URL (–¥–ª—è –¥–µ–º–æ).

üë§ –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
GET /me
–¢—Ä–µ–±—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫: Authorization: Bearer <–≤–∞—à_—Ç–æ–∫–µ–Ω>
‚Üí –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:

json
```
{¬†¬†"id":¬†"65a...",¬†¬†
    "email":¬†"user@example.com",¬†¬†
    "auth_method":¬†"code",¬†// –∏–ª–∏ "github", "yandex"
    "external_id":¬†"email:user@example.com"¬†//¬†–∏–ª–∏¬†"gh_12345"
}
```
#### üß© –ö–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
#### –î–ª—è Web-–∫–ª–∏–µ–Ω—Ç–∞
- –ü—Ä–∏ –≤—Ö–æ–¥–µ –≤—ã–∑—ã–≤–∞–π—Ç–µ –Ω—É–∂–Ω—ã–π –º–µ—Ç–æ–¥:
/auth/code/request ‚Üí /auth/code/verify (–ø–æ –∫–æ–¥—É),
/auth/github (GitHub),
/auth/yandex (–Ø–Ω–¥–µ–∫—ÅID).
- –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π access_token.
- –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö –∫ –¥—Ä—É–≥–∏–º —Å–µ—Ä–≤–∏—Å–∞–º –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫:
http
````
Authorization:¬†Bearer¬†eyJhbGciOi...
````
- –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî –≤—ã–∑—ã–≤–∞–π—Ç–µ GET /me.
 
#### –î–ª—è Telegram-–±–æ—Ç–∞
- –ë–æ—Ç –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å /auth/code/request —Å email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- –ö–æ–¥ –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Telegram (–≤ –±—É–¥—É—â–µ–º ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ–º).
- –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–¥–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî –≤—ã–∑–≤–∞—Ç—å /auth/code/verify.

#### –î–ª—è –º–æ–¥—É–ª—è —Ç–µ—Å—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ user.id –∏–∑ /me –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–æ–≤ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
- –•—Ä–∞–Ω–∏—Ç–µ external_id, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Ä–∞–∑–ª–∏—á–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏ (email, GitHub, –Ø–Ω–¥–µ–∫—Å).
